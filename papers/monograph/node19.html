<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002 (1.62) JA patch-1.4
patched version by:  Kenshi Muto, Debian Project.
LaTeX2HTML 2002 (1.62),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Detecting Discontinuities:
Line Field Model</TITLE>
<META NAME="description" CONTENT="Detecting Discontinuities:
Line Field Model">
<META NAME="keywords" CONTENT="kmono">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2002 JA patch-1.4">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="kmono.css">

<LINK REL="next" HREF="node20.html">
<LINK REL="previous" HREF="node17.html">
<LINK REL="up" HREF="node13.html">
<LINK REL="next" HREF="node20.html">
</HEAD>

<BODY >

<A NAME="tex2html451"
  HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.gif"></A> 
<A NAME="tex2html447"
  HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.gif"></A> 
<A NAME="tex2html441"
  HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.gif"></A> 
<A NAME="tex2html449"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/share/latex2html/icons/contents.gif"></A>  <BR>
<B> Next:</B> <A NAME="tex2html452"
  HREF="node20.html">Minimizing posteriori energy</A>
<B>Up:</B> <A NAME="tex2html448"
  HREF="node13.html">Markov Random Field Models</A>
<B> Previous:</B> <A NAME="tex2html442"
  HREF="node18.html">Neighborhood for the Posterior</A>
<BR> <P>

<!--End of Navigation Panel-->

<H2><A NAME="SECTION00525000000000000000">
Detecting Discontinuities:
Line Field Model</A>
</H2>

<P>
It is well known that in case of images  important 
information is conveyed at points where there is a 
significant change in the  image irradiance. 
Such changes correspond to changes in the surface property; 
these could be due to changes in depth, texture, surface 
orientation, source orientation, changes due to motion, or 
some other surface attribute. Thus it is important to 
incorporate a component to account for the presence or 
absence of discontinuities.

<P>
Geman and Geman [<A
 HREF="node80.html#jr_Gema_84">79</A>]  introduced the concept of line 
field
located on the dual lattice to detect discontinuities.
This dual lattice has two sites, each corresponding to the vertical
and horizontal line fields. The horizontal line field <IMG
 WIDTH="480" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img114.gif"
 ALT="$l_{ij}$">
connects site <IMG
 WIDTH="612" HEIGHT="84" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.gif"
 ALT="$(i,j)$"> to <IMG
 WIDTH="70" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img31.gif"
 ALT="$(i,j-1)$">; this
will aid in detecting a horizontal edge.  Similarly, vertical
line field <IMG
 WIDTH="28" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img115.gif"
 ALT="$v_{i,j}$"> connects site <IMG
 WIDTH="612" HEIGHT="84" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.gif"
 ALT="$(i,j)$"> to <IMG
 WIDTH="40" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img29.gif"
 ALT="$(i-1,j)$"> and this will
help in detecting a vertical edge. 
Note that <IMG
 WIDTH="21" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img116.gif"
 ALT="$l_{i,j}$"> and <IMG
 WIDTH="28" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img115.gif"
 ALT="$v_{i,j}$"> are
<!-- MATH
 $\left \{ 0, 1 \right \}$
 -->
<IMG
 WIDTH="28" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img117.gif"
 ALT="$\left \{ 0, 1 \right \}$"> variables, and the corresponding 
line fields,  <IMG
 WIDTH="25" HEIGHT="32" ALIGN="BOTTOM" BORDER="0"
 SRC="img118.gif"
 ALT="$L$"> and <IMG
 WIDTH="47" HEIGHT="34" ALIGN="BOTTOM" BORDER="0"
 SRC="img119.gif"
 ALT="$V$">,  are binary.

<P>
Now, within the Bayesian framework, 
we can define a Gibbs (MRF) prior  distribution 
that combines the image <IMG
 WIDTH="22" HEIGHT="32" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$X$">, the horizontal line field <IMG
 WIDTH="25" HEIGHT="32" ALIGN="BOTTOM" BORDER="0"
 SRC="img118.gif"
 ALT="$L$">
and the vertical line field <IMG
 WIDTH="47" HEIGHT="34" ALIGN="BOTTOM" BORDER="0"
 SRC="img119.gif"
 ALT="$V$">; 

<P>
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
P[ X=x, L=l, V=v ]  = \frac{ \exp^{-U(x,l,v)}}{Z}
\end{displaymath}
 -->

<IMG
 WIDTH="12" HEIGHT="16" BORDER="0"
 SRC="img120.gif"
 ALT="\begin{displaymath}P[ X=x, L=l, V=v ] = \frac{ \exp^{-U(x,l,v)}}{Z}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
and
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
Z = \sum_{x,l,v} \exp^{ - U(x,l,v) }
\end{displaymath}
 -->

<IMG
 WIDTH="13" HEIGHT="16" BORDER="0"
 SRC="img121.gif"
 ALT="\begin{displaymath}
Z = \sum_{x,l,v} \exp^{ - U(x,l,v) }
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
where <IMG
 WIDTH="503" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img122.gif"
 ALT="$U(x,l,v)$"> is given by
<BR>
<DIV ALIGN="CENTER"><A NAME="eq:e11a"></A>
<!-- MATH
 \begin{eqnarray}
\displaystyle { \sum_{c \in {\cal C}} V_{c}(x,l,v) } &=&
\displaystyle  \sum_{i,j}^{}  \mu  \left\{ \right .
( x_{i,j} - x_{i,j-1} )^2 ( 1 - v_{i,j} )   \nonumber \\
& + &  ( x_{i,j+1} - x_{i,j} )^2 ( 1 - v_{i,j+1} )  \nonumber  \\
& + &  ( x_{i,j} - x_{i-1,j} )^2 ( 1 - l_{i,j} )   \nonumber \\
& + &  ( x_{i+1,j} - x_{i,j} )^2 ( 1 - l_{i+1,j} ) \left . \right\} \nonumber \\
         & + & \gamma\;\; \left \{ l_{i,j} + l_{i+1,j}  + v_{i,j} + v_{i,j+1} 
													\right\}  \nonumber \\
\end{eqnarray}
 -->
<TABLE ALIGN="CENTER" CELLPADDING="0" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="434" HEIGHT="48" ALIGN="MIDDLE" BORDER="0"
 SRC="img123.gif"
 ALT="$\displaystyle \displaystyle { \sum_{c \in {\cal C}} V_{c}(x,l,v) }$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="128" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img82.gif"
 ALT="$\textstyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="72" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img124.gif"
 ALT="$\displaystyle \displaystyle \sum_{i,j}^{} \mu \left\{ \right .
( x_{i,j} - x_{i,j-1} )^2 ( 1 - v_{i,j} )$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="101" HEIGHT="52" ALIGN="MIDDLE" BORDER="0"
 SRC="img125.gif"
 ALT="$\textstyle +$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="235" HEIGHT="55" ALIGN="MIDDLE" BORDER="0"
 SRC="img126.gif"
 ALT="$\displaystyle ( x_{i,j+1} - x_{i,j} )^2 ( 1 - v_{i,j+1} )$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="101" HEIGHT="52" ALIGN="MIDDLE" BORDER="0"
 SRC="img125.gif"
 ALT="$\textstyle +$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img127.gif"
 ALT="$\displaystyle ( x_{i,j} - x_{i-1,j} )^2 ( 1 - l_{i,j} )$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="101" HEIGHT="52" ALIGN="MIDDLE" BORDER="0"
 SRC="img125.gif"
 ALT="$\textstyle +$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="199" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img128.gif"
 ALT="$\displaystyle ( x_{i+1,j} - x_{i,j} )^2 ( 1 - l_{i+1,j} ) \left . \right\}$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="101" HEIGHT="52" ALIGN="MIDDLE" BORDER="0"
 SRC="img125.gif"
 ALT="$\textstyle +$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="179" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img129.gif"
 ALT="$\displaystyle \gamma\;\; \left \{ l_{i,j} + l_{i+1,j} + v_{i,j} + v_{i,j+1}
\right\}$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
The term in the first bracket (multiplying <IMG
 WIDTH="164" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img87.gif"
 ALT="$\mu$">)
signifies the interaction
between the neighboring pixels; if the gradient is
high (determined by a preset threshold), then the corresponding line
field will get activated  to indicate a discontinuity. 
For example 
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\begin{tabular}{lllll}
$l_{i,j}$\  & = & $1$\   &if & $|x_{i,j} - x_{i-1,j}| >$\  threshold\\
          & = & $0$\  & & otherwise\\
\end{tabular}
\end{displaymath}
 -->

<IMG
 WIDTH="203" HEIGHT="38" BORDER="0"
 SRC="img130.gif"
 ALT="\begin{displaymath}
\begin{tabular}{lllll}
$l_{i,j}$\ &amp; = &amp; $1$\ &amp;if &amp; $\vert x_...
...ert &gt;$\ threshold\\
&amp; = &amp; $0$\ &amp; &amp; otherwise\\
\end{tabular}\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
The terms in the
second bracket (multiplying <IMG
 WIDTH="232" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img131.gif"
 ALT="$\gamma$">)
provide a penalty for  every discontinuity created and also
prevent  spurious discontinuities. Such line fields have been used earlier
by Marroquin <EM>et al</EM> [<A
 HREF="node80.html#jr_Marr_87">90</A>] and Geiger and
Girosi [<A
 HREF="node80.html#jr_Geig_91">87</A>]. Note that Markovianess is still 
preserved. For the purpose of illustration we have specified line 
filed models using a first order neighborhood for the 
cliques. Nevertheless, more complex line field models can be
used; often one uses a second order line field model (see 
Graffigne and Geman [<A
 HREF="node80.html#graffigne1">91</A>]).
Using the line field model, the posterior distribution 
can be expressed as
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
P[X=x, L=l, V=v \mid Y=y] = \frac{1}{Z} \exp^{-U^{p}(x,l,v)}
\end{displaymath}
 -->

<IMG
 WIDTH="277" HEIGHT="42" BORDER="0"
 SRC="img132.gif"
 ALT="\begin{displaymath}
P[X=x, L=l, V=v \mid Y=y] = \frac{1}{Z} \exp^{-U^{p}(x,l,v)}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
where the posterior energy function 
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
U^{p}(x,l,v) = U(x,l,v) 
           + \frac{\| \mu - \odot^{-1}(y,\phi(x)) \|^{2}}
                        {2 \sigma^{2} }
\end{displaymath}
 -->

<IMG
 WIDTH="10" HEIGHT="31" BORDER="0"
 SRC="img133.gif"
 ALT="\begin{displaymath}
U^{p}(x,l,v) = U(x,l,v)
+ \frac{\Vert \mu - \odot^{-1}(y,\phi(x)) \Vert^{2}}
{2 \sigma^{2} }
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P> 

<P>
As seen, the solution of any vision task formulated in a MRF framework reduces 
in computing the MAP
estimate of the attribute of interest. This is 
 equivalent to minimizing the posteriori energy function
(<A HREF="node17.html#eq:mrf_min">2.13</A>). The posteriori energy function is generally 
non-convex in nature.

<P>
<HR>
<A NAME="tex2html451"
  HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.gif"></A> 
<A NAME="tex2html447"
  HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.gif"></A> 
<A NAME="tex2html441"
  HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.gif"></A> 
<A NAME="tex2html449"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/share/latex2html/icons/contents.gif"></A>  <BR>
<B> Next:</B> <A NAME="tex2html452"
  HREF="node20.html">Minimizing posteriori energy</A>
<B>Up:</B> <A NAME="tex2html448"
  HREF="node13.html">Markov Random Field Models</A>
<B> Previous:</B> <A NAME="tex2html442"
  HREF="node18.html">Neighborhood for the Posterior</A>

<!--End of Navigation Panel-->
<ADDRESS>
<I> <BR>
2004-02-10</I>
</ADDRESS>
</BODY>
</HTML>
